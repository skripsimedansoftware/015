<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Document</title>
</head>
<body>
<style>
body{ background-color: ivory; }
#canvas{border:1px solid red; margin:0 auto; }
</style>
<canvas id="canvas" width=300 height=300></canvas>
</body>
<script>
var canvas=document.getElementById("canvas");
var ctx=canvas.getContext("2d");

var img=new Image();
img.crossOrigin = "Anonymous";
img.onload=function(){
  canvas.width=img.width;
  canvas.height=img.height;
  ctx.drawImage(img,0,0);
  var uint8 = new Uint8ClampedArray(img.width*img.height);
  var imageData = ctx.getImageData(0,0,canvas.width,canvas.height);
  var data= imageData.data
  for (var i = 0; i < data.length; i += 4) {
    var grayscale = data[i]*0.2126 + data[i +1]*0.7152 + data[i +2]*0.0722;
    uint8[i]=grayscale;
  }

  // console.log(uint8);
var s=uint8[0];
for(var i=0;i<uint8.length;i++){
  console.log(uint8[i]);
    // s+=','+uint8[i];
}

// console.log(s);
// console.log(s);
  // alert('As string: '+s);
  var b64=btoa(s);
  // console.log(b64);
  // alert('As base64 string'+b64);
  // var ss=atob(b64);
  // alert('Back to original string'+ss);
}
img.src='http://localhost/color-histogram/web-app/images/20x30.jpg'
</script>
</html>
